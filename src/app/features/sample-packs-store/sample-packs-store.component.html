<div class="sample-store-container">
  <!-- Cart Icon (Fixed Position) -->
  <div class="cart-icon-container">
    <app-cart-icon (cartToggled)="toggleCart()"></app-cart-icon>
  </div>

  <!-- Header Section -->
  <div class="store-header">
    <div class="header-content">
      <h1 class="store-title">{{ title }}</h1>
      <p class="store-subtitle">{{ subtitle }}</p>
    </div>
  </div>

  <!-- Featured Section -->
  <section class="featured-section" *ngIf="featuredPacks().length > 0">
    <h2 class="section-title">Featured Packs</h2>
    <div class="featured-grid">
      <div class="featured-card" *ngFor="let pack of featuredPacks().slice(0, 2)">
        <div class="card-image">
          <img [src]="pack.imageUrl" [alt]="pack.title" />
          <div class="overlay">
            <button class="play-btn" (click)="toggleAudioPreview(pack.id)">
              <svg *ngIf="currentlyPlaying() !== pack.id" width="24" height="24" viewBox="0 0 24 24" fill="white">
                <path d="M8 5v14l11-7z"/>
              </svg>
              <svg *ngIf="currentlyPlaying() === pack.id" width="24" height="24" viewBox="0 0 24 24" fill="white">
                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
              </svg>
            </button>
          </div>
          <div class="badges">
            <span class="badge new" *ngIf="pack.isNew">NEW</span>
            <span class="badge discount" *ngIf="pack.discount">-{{ pack.discount }}%</span>
          </div>
        </div>
        <div class="card-content">
          <div class="card-header">
            <h3 class="pack-title">{{ pack.title }}</h3>
            <p class="pack-artist">by {{ pack.artist }}</p>
          </div>
          <div class="pack-info">
            <span class="genre-tag">{{ pack.genre }}</span>
            <span class="bpm-info">{{ pack.bpm }} BPM</span>
            <span class="track-count">{{ pack.trackCount }} tracks</span>
          </div>
          <p class="pack-description">{{ pack.description }}</p>
          <div class="pack-tags">
            <span class="tag" *ngFor="let tag of pack.tags.slice(0, 3)">#{{ tag }}</span>
          </div>
          <div class="price-section">
            <div class="price">
              <span class="current-price">${{ pack.price }}</span>
              <span class="original-price" *ngIf="pack.originalPrice">${{ pack.originalPrice }}</span>
            </div>
            <div class="action-buttons">
              <button class="btn-secondary" (click)="addToCart(pack)">Add to Cart</button>
              <button class="btn-primary" (click)="buyNow(pack)">Buy Now</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Filter Section -->
  <section class="filter-section">
    <h2 class="section-title">All Sample Packs</h2>
    <div class="genre-filters">
      <button
        *ngFor="let genre of genres"
        class="filter-btn"
        [class.active]="selectedGenre() === genre"
        (click)="selectGenre(genre)">
        {{ genre }}
      </button>
    </div>
  </section>

  <!-- Products Grid -->
  <section class="products-section">
    <!-- Loading Indicator -->
    <div class="loading-indicator" *ngIf="isLoading()">
      <div class="loading-spinner"></div>
      <p>Loading sample packs...</p>
    </div>

    <!-- Products Grid -->
    <div class="products-grid" *ngIf="!isLoading()">
      <div class="product-card" *ngFor="let pack of samplePacks()">
        <div class="card-image">
          <img [src]="pack.imageUrl" [alt]="pack.title" />
          <div class="overlay">
            <button class="play-btn" (click)="toggleAudioPreview(pack.id)">
              <svg *ngIf="currentlyPlaying() !== pack.id" width="20" height="20" viewBox="0 0 24 24" fill="white">
                <path d="M8 5v14l11-7z"/>
              </svg>
              <svg *ngIf="currentlyPlaying() === pack.id" width="20" height="20" viewBox="0 0 24 24" fill="white">
                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
              </svg>
            </button>
          </div>
          <div class="badges">
            <span class="badge new" *ngIf="pack.isNew">NEW</span>
            <span class="badge discount" *ngIf="pack.discount">-{{ pack.discount }}%</span>
          </div>
        </div>
        <div class="card-content">
          <h3 class="pack-title">{{ pack.title }}</h3>
          <p class="pack-artist">by {{ pack.artist }}</p>
          <div class="pack-meta">
            <span class="genre">{{ pack.genre }}</span>
            <span class="bpm">{{ pack.bpm }} BPM</span>
            <span class="tracks">{{ pack.trackCount }} tracks</span>
          </div>
          <div class="pack-tags">
            <span class="tag" *ngFor="let tag of pack.tags.slice(0, 2)">#{{ tag }}</span>
          </div>
          <div class="price-actions">
            <div class="price">
              <span class="current-price">${{ pack.price }}</span>
              <span class="original-price" *ngIf="pack.originalPrice">${{ pack.originalPrice }}</span>
            </div>
            <div class="actions">
              <button class="btn-cart" (click)="addToCart(pack)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path d="m1 1 4 4v11h14l2-10H6"></path>
                </svg>
              </button>
              <button class="btn-buy" (click)="buyNow(pack)">Buy</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination Section -->
    <div class="pagination-section" *ngIf="!isLoading() && totalItems() > 0">
      <!-- Items per page selector -->
      <div class="items-per-page">
        <span class="label">Show:</span>
        <select
          class="items-select"
          [value]="pageSize()"
          (change)="onPageSizeChange($event)">
          <option *ngFor="let option of pageSizeOptions" [value]="option">
            {{ option }} items
          </option>
        </select>
      </div>

      <!-- Page info -->
      <div class="page-info">
        <span>
          Showing {{ startIndex() }} - {{ endIndex() }} of {{ totalItems() }} results
        </span>
      </div>

      <!-- Pagination controls -->
      <div class="pagination-controls" *ngIf="totalPages() > 1">
        <!-- Previous button -->
        <button
          class="page-btn"
          [class.disabled]="!hasPreviousPage()"
          (click)="previousPage()"
          [disabled]="!hasPreviousPage()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m15 18-6-6 6-6"/>
          </svg>
        </button>

        <!-- Page numbers -->
        <button
          *ngFor="let page of pageNumbers()"
          class="page-btn"
          [class.active]="currentPage() === page"
          (click)="changePage(page)">
          {{ page }}
        </button>

        <!-- Next button -->
        <button
          class="page-btn"
          [class.disabled]="!hasNextPage()"
          (click)="nextPage()"
          [disabled]="!hasNextPage()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m9 18 6-6-6-6"/>
          </svg>
        </button>
      </div>
    </div>
  </section>  <!-- Cart Section Separator -->
  <div class="cart-section-separator">
    <div class="separator-line"></div>
    <span class="separator-text">Shopping Cart</span>
    <div class="separator-line"></div>
  </div>

  <!-- Cart Modal -->
  <app-cart
    [isOpen]="isCartOpen()"
    [showBackdrop]="true"
    [showCloseButton]="true"
    (cartClosed)="closeCart()"
    (purchaseCompleted)="onPurchaseCompleted($event)">
  </app-cart>
</div>
